<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smart Encyclopedia – Daily Knowledge Articles</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
        rel="stylesheet">

  <style>
    body {
      background-color: #f5f6fa;
    }

    .article-card img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      object-position: center;
      border-radius: 12px 12px 0 0;
      background-color: #e6e6e6;
    }
  </style>
</head>

<body>

  <main class="py-4">
    <div class="container">
      <div class="row g-4" id="articles-grid">
      </div>
    </div>
  </main>

  <script>
    const API_BASE = "";

    function getDateOnly(dateStr) {
      return new Date(dateStr).toISOString().split("T")[0];
    }

    async function loadArticles() {
      const container = document.getElementById("articles-grid");
      try {
        const res = await fetch(`${API_BASE}/api/articles`);
        const data = await res.json();
        if (!data.length) return;

        data.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
        const latestDate = getDateOnly(data[0].created_at);

        const latestArticles = data.filter(a =>
          getDateOnly(a.created_at) === latestDate
        );

        container.innerHTML = latestArticles.map(a => {
          const created = new Date(a.created_at).toLocaleDateString();
          const imgSrc = a.image_url || "https://via.placeholder.com/600x300";
          const text = (a.content || "").replace(/<[^>]+>/g, "").slice(0, 150) + "...";
          return `
            <div class="col-12 col-md-6 col-lg-4">
              <div class="card article-card h-100 shadow-sm border-0">
                <img src="${imgSrc}" alt="${a.title}">
                <div class="card-body">
                  <div class="text-muted small">${a.category || "General"} • ${created}</div>
                  <h5>${a.title}</h5>
                  <p>${text}</p>
                  <a href="article.html?slug=${a.slug}" class="text-primary">
                    Read more →
                  </a>
                </div>
              </div>
            </div>`;
        }).join("");

      } catch (err) {
        console.error(err);
      }
    }

    loadArticles();
  </script>

</body>
</html>
